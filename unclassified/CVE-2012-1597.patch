From 58854564c7b8672090c25c4b1677d08620d870f2 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Andre=CC=81=20R?= <ar@ez.no>
Date: Wed, 9 May 2012 12:17:22 +0200
Subject: [PATCH] Fixed #019245: XSS exploit on eZJSCore RUN command

---
 classes/ezjscajaxcontent.php | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/classes/ezjscajaxcontent.php b/classes/ezjscajaxcontent.php
index bab1cf92..97610b16 100644
--- a/classes/ezjscajaxcontent.php
+++ b/classes/ezjscajaxcontent.php
@@ -127,7 +127,7 @@ public static function textEncode( $mix )
         if ( is_array( $mix ) )
             return implode(',', array_map( array('ezjscAjaxContent', 'textEncode'), array_filter( $mix ) ) );
 
-        return $mix;
+        return htmlspecialchars( $mix );
     }
 
     /**
