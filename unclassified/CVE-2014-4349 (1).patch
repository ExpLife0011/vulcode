From daa98d0c7ed24b529dc5df0d5905873acd0b00be Mon Sep 17 00:00:00 2001
From: "Ann + J.M" <phpMyAdmin@ZweiSteinSoft.de>
Date: Thu, 19 Jun 2014 14:27:23 +0200
Subject: [PATCH] Fix XSS in Hide navigation items feature

Signed-off-by: Ann + J.M <phpMyAdmin@ZweiSteinSoft.de>
---
 libraries/navigation/Navigation.class.php               | 6 +++---
 libraries/navigation/Nodes/Node_DatabaseChild.class.php | 6 +++---
 2 files changed, 6 insertions(+), 6 deletions(-)

diff --git a/libraries/navigation/Navigation.class.php b/libraries/navigation/Navigation.class.php
index b7827f6b1cd..d036c7e54cc 100644
--- a/libraries/navigation/Navigation.class.php
+++ b/libraries/navigation/Navigation.class.php
@@ -189,9 +189,9 @@ public function getItemUnhideDialog($dbName, $itemType = null, $tableName = null
                         $html .= '<td style="width:80px"><a href="navigation.php?'
                             . PMA_URL_getCommon()
                             . '&unhideNavItem=true'
-                            . '&itemType=' . $t
-                            . '&itemName=' . urldecode($hiddenItem)
-                            . '&dbName=' . urldecode($dbName) . '"'
+                            . '&itemType=' . urlencode($t)
+                            . '&itemName=' . urlencode($hiddenItem)
+                            . '&dbName=' . urlencode($dbName) . '"'
                             . ' class="unhideNavItem ajax">'
                             . PMA_Util::getIcon('lightbulb.png', __('Show'))
                             .  '</a></td>';
diff --git a/libraries/navigation/Nodes/Node_DatabaseChild.class.php b/libraries/navigation/Nodes/Node_DatabaseChild.class.php
index 36e8a377001..5af12778d22 100644
--- a/libraries/navigation/Nodes/Node_DatabaseChild.class.php
+++ b/libraries/navigation/Nodes/Node_DatabaseChild.class.php
@@ -32,9 +32,9 @@ public function getHtmlForControlButtons()
                 . '<a href="navigation.php?'
                 . PMA_URL_getCommon()
                 . '&hideNavItem=true'
-                . '&itemType=' . urldecode($this->getItemType())
-                . '&itemName=' . urldecode($item)
-                . '&dbName=' . urldecode($db) . '"'
+                . '&itemType=' . urlencode($this->getItemType())
+                . '&itemName=' . urlencode($item)
+                . '&dbName=' . urlencode($db) . '"'
                 . ' class="hideNavItem ajax">'
                 . PMA_Util::getImage('lightbulb_off', __('Hide'))
                 . '</a></span>';
