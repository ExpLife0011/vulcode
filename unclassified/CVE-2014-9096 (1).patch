From efb967b944375cd3ea3cd84c80d86d339dbe030e Mon Sep 17 00:00:00 2001
From: yankidank <eric@pligg.com>
Date: Wed, 30 Jul 2014 09:15:22 -0700
Subject: [PATCH] - Security fix applied to address a vulnerability

---
 recover.php | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/recover.php b/recover.php
index c9fcbef5..9efb96bb 100644
--- a/recover.php
+++ b/recover.php
@@ -26,8 +26,8 @@
 	if (strpos($_POST['return'],$my_pligg_base)!==0) $_POST['return']=$my_pligg_base . '/';
 }
 
-$id=$_REQUEST['id'];
-$n=$_REQUEST['n'];
+$id=sanitize($_REQUEST['id'], 3);
+$n=sanitize($_REQUEST['n'], 3);
 $username=base64_decode($id);
 $sql="SELECT * FROM `" . table_users . "` where `user_login` = '".$username."' AND `last_reset_request` = FROM_UNIXTIME('".$n."') AND user_level!='Spammer'";
 		
