From 23c8d21c75242999e29379e6ca8418a14c8725c6 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Adrian=20Schr=C3=B6ter?= <adrian@suse.de>
Date: Mon, 14 Mar 2011 11:27:26 +0100
Subject: [PATCH] [backend] verify file names return by source service (do not
 allow files with new lines #679151)

---
 src/backend/bs_srcserver | 1 +
 1 file changed, 1 insertion(+)

diff --git a/src/backend/bs_srcserver b/src/backend/bs_srcserver
index 3e3da245bd..40e83805fd 100755
--- a/src/backend/bs_srcserver
+++ b/src/backend/bs_srcserver
@@ -203,6 +203,7 @@ sub runservice {
 	unlink($lockfile);
 	die("ERROR: bs_service returned a non-_service file\n");
       }
+      BSVerify::verify_filename($pfile);
       $files->{$pfile} = addfile($projid, $packid, "$odir/$pfile", $pfile);
     }
   } else {
