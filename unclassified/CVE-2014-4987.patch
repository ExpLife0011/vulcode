From 395265e9937beb21134626c01a21f44b28e712e5 Mon Sep 17 00:00:00 2001
From: Marc Delisle <marc@infomarc.info>
Date: Thu, 17 Jul 2014 17:30:44 -0400
Subject: [PATCH] bug #4491 [security] Missing validation for accessing User
 groups feature

Signed-off-by: Marc Delisle <marc@infomarc.info>
---
 ChangeLog              |  1 +
 server_user_groups.php | 10 +++++++++-
 2 files changed, 10 insertions(+), 1 deletion(-)

diff --git a/ChangeLog b/ChangeLog
index 66c51992da8..d6089b41854 100644
--- a/ChangeLog
+++ b/ChangeLog
@@ -16,6 +16,7 @@ phpMyAdmin - ChangeLog
 - bug #4486 [security] XSS injection due to unescaped table comment
 - bug #4488 [security] XSS injection due to unescaped table name (triggers)
 - bug #4492 [security] XSS in AJAX confirmation messages
+- bug #4491 [security] Missing validation for accessing User groups feature
 
 4.2.5.0 (2014-06-26)
 - bug #4467 shell_exec() has been disabled for security reasons
diff --git a/server_user_groups.php b/server_user_groups.php
index 7236a916155..0d7358e7d86 100644
--- a/server_user_groups.php
+++ b/server_user_groups.php
@@ -20,6 +20,14 @@
 $scripts  = $header->getScripts();
 $scripts->addFile('server_user_groups.js');
 
+/**
+ * Only allowed to superuser 
+ */
+if (! $GLOBALS['is_superuser']) {
+    $response->addHTML(PMA_Message::error(__('No Privileges'))->getDisplay());
+    exit;
+}
+
 $response->addHTML('<div>');
 $response->addHTML(PMA_getHtmlForSubMenusOnUsersPage('server_user_groups.php'));
 
@@ -61,4 +69,4 @@
 }
 
 $response->addHTML('</div>');
-?>
\ No newline at end of file
+?>
