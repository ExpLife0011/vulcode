From 264bf55719baacc069ff9d3cc35f0c349cde11e3 Mon Sep 17 00:00:00 2001
From: Garvin Hicking <blog@garv.in>
Date: Sun, 22 Apr 2012 20:29:37 +0200
Subject: [PATCH] backend media

---
 docs/NEWS                            | 2 +-
 serendipity_admin_image_selector.php | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/docs/NEWS b/docs/NEWS
index 719e614e4..349f91b95 100644
--- a/docs/NEWS
+++ b/docs/NEWS
@@ -6,7 +6,7 @@ Version 1.6.1 ()
 ------------------------------------------------------------------------
 
     * Improved escaping of backend plugin management for DB query
-      (Stefan Schurtz)
+      and media selector output (Stefan Schurtz)
           
     * Updated spamblock plugin to 1.78 & 1.79
       changed wordfilter to function to check with 'verify_once'
diff --git a/serendipity_admin_image_selector.php b/serendipity_admin_image_selector.php
index aba635b45..d2cba0a5d 100644
--- a/serendipity_admin_image_selector.php
+++ b/serendipity_admin_image_selector.php
@@ -293,7 +293,7 @@
           isset($serendipity['GET']['page'])   ? $serendipity['GET']['page']   : 1,
           $serendipity['thumbPerPage2'],
           ($serendipity['showMediaToolbar'] ? true : false),
-          '?serendipity[step]=1' . $add_url . '&amp;serendipity[textarea]='. $serendipity['GET']['textarea'],
+          '?serendipity[step]=1' . $add_url . '&amp;serendipity[textarea]='. htmlspecialchars($serendipity['GET']['textarea']),
           true,
           null,
           false
