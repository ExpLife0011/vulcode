From 489b6050f6c53fe7b24c4bed3eeb9c25543960e2 Mon Sep 17 00:00:00 2001
From: LaboCnil <deip@cnil.fr>
Date: Tue, 4 Nov 2014 11:30:34 +0100
Subject: [PATCH] Patch vulnerabilities

Patch vulnerabilities :
CVE-2014-8352
CVE-2014-8351
---
 cookieviz/info.php | 10 ++++++++--
 cookieviz/json.php |  8 ++++++--
 2 files changed, 14 insertions(+), 4 deletions(-)

diff --git a/cookieviz/info.php b/cookieviz/info.php
index 9344255..84cffba 100755
--- a/cookieviz/info.php
+++ b/cookieviz/info.php
@@ -1,4 +1,4 @@
-<?php
+﻿<?php
 /*Copyright (c) 2013, Stéphane Petitcolas
 This file is part of CookieViz
 
@@ -20,8 +20,14 @@
 
 if(isset($_GET["domain"]))
 {
-	$domain = $_GET["domain"];
+	$domain = mysql_real_escape_string($_GET["domain"]);
+	
 }
+else
+{
+	exit;
+}
+
 echo '<table id="infos">';
  echo "<thead>";
  echo "<tr>";
diff --git a/cookieviz/json.php b/cookieviz/json.php
index d9b9147..7b5d5e2 100755
--- a/cookieviz/json.php
+++ b/cookieviz/json.php
@@ -23,12 +23,16 @@
 
 if(isset($_GET["max_date"]))
 {
-	$init_max_date = $_GET["max_date"];
+	$init_max_date = 	mysql_real_escape_string($_GET["max_date"]);
+	if (!is_numeric($init_max_date))
+	{
+		$init_max_date="";
+	}
 }
 
 if(isset($_GET["domain"]))
 {
-	$domain = $_GET["domain"];
+	$domain = mysql_real_escape_string($_GET["domain"]);
 }
 
 $max_date = $init_max_date;
