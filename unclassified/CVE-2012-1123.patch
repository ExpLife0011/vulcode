From f5106be52cf6aa72c521f388e4abb5f0de1f1d7f Mon Sep 17 00:00:00 2001
From: root <root@paul.shroudbox.com>
Date: Thu, 16 Feb 2012 09:41:56 +0000
Subject: [PATCH] Fix 0013901: SOAP API allows invoking methods without proper
 authentication

Note: only applied to 1.2.x not 'next', as the code is changing anyway
---
 api/soap/mc_api.php | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/api/soap/mc_api.php b/api/soap/mc_api.php
index 507680f490..a81781ae1b 100644
--- a/api/soap/mc_api.php
+++ b/api/soap/mc_api.php
@@ -51,6 +51,11 @@ function mci_check_login( $p_username, $p_password ) {
 
 		# do not use password validation.
 		$p_password = null;
+	} else {
+		if( is_blank( $p_password ) ) {
+			# require password for authenticated access
+			return false;
+		}
 	}
 
 	if( false === auth_attempt_script_login( $p_username, $p_password ) ) {
