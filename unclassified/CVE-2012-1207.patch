From a9986b86c53de0582248b39605660fbba0c21a29 Mon Sep 17 00:00:00 2001
From: Frederik Heyninck <frederikheyninck@gmail.com>
Date: Mon, 13 Feb 2012 16:13:35 +0100
Subject: [PATCH] XSS / LFI Fox

---
 frontend/core/engine/javascript.php | 11 +++++++++++
 1 file changed, 11 insertions(+)

diff --git a/frontend/core/engine/javascript.php b/frontend/core/engine/javascript.php
index 8de23787d3..b25b0a138a 100644
--- a/frontend/core/engine/javascript.php
+++ b/frontend/core/engine/javascript.php
@@ -194,6 +194,17 @@ private function setLanguage($value)
 	 */
 	private function setModule($value)
 	{
+		$modules = (array) FrontendModel::getModules();
+		
+		if(!in_array((string) $value, $modules))
+		{
+			// when debug is on throw an exception
+			if(SPOON_DEBUG) throw new FrontendException('Invalid file.');
+
+			// when debug is of show a descent message
+			else exit(SPOON_DEBUG_MESSAGE);
+		}
+		
 		$this->module = (string) $value;
 	}
 }
