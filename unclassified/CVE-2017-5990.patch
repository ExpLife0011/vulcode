From f2a32dede7cc7f9ff59fe983c5e4abe2966d837c Mon Sep 17 00:00:00 2001
From: Dave Premo <dave.premo@phreesoft.com>
Date: Mon, 13 Feb 2017 12:36:27 -0600
Subject: [PATCH] Fix for security issue

---
 extensions/ShippingMethods/ups/label_mgr/js_include.php          | 1 -
 extensions/ShippingMethods/yrc/label_mgr/js_include.php          | 2 --
 trunk/modules/shipping/methods/fedex_v7/label_mgr/js_include.php | 1 -
 trunk/modules/shipping/pages/popup_shipping/js_include.php       | 4 +---
 4 files changed, 1 insertion(+), 7 deletions(-)

diff --git a/extensions/ShippingMethods/ups/label_mgr/js_include.php b/extensions/ShippingMethods/ups/label_mgr/js_include.php
index 64fa9c04..882e3ad0 100644
--- a/extensions/ShippingMethods/ups/label_mgr/js_include.php
+++ b/extensions/ShippingMethods/ups/label_mgr/js_include.php
@@ -23,7 +23,6 @@
 <!--
 // pass any php variables generated during pre-process that are used in the javascript functions.
 // Include translations here as well.
-var formName          = "<?php echo $_GET['form']; ?>"; 
 var image_delete_text = '<?php echo TEXT_DELETE; ?>';
 var image_delete_msg  = '<?php echo SHIPPING_DELETE_CONFIRM; ?>';
 <?php echo js_calendar_init($cal_ship); ?>
diff --git a/extensions/ShippingMethods/yrc/label_mgr/js_include.php b/extensions/ShippingMethods/yrc/label_mgr/js_include.php
index a227bea6..6c0f0058 100644
--- a/extensions/ShippingMethods/yrc/label_mgr/js_include.php
+++ b/extensions/ShippingMethods/yrc/label_mgr/js_include.php
@@ -3,7 +3,6 @@
 // |                   PhreeBooks Open Source ERP                    |
 // +-----------------------------------------------------------------+
 // | Copyright(c) 2008-2014 PhreeSoft      (www.PhreeSoft.com)       |
-
 // +-----------------------------------------------------------------+
 // | This program is free software: you can redistribute it and/or   |
 // | modify it under the terms of the GNU General Public License as  |
@@ -22,7 +21,6 @@
 <!--
 // pass any php variables generated during pre-process that are used in the javascript functions.
 // Include translations here as well.
-var formName          = "<?php echo $_GET['form']; ?>"; 
 var image_delete_text = '<?php echo TEXT_DELETE; ?>';
 var image_delete_msg  = '<?php echo SHIPPING_DELETE_CONFIRM; ?>';
 <?php echo js_calendar_init($cal_ship); ?>
diff --git a/trunk/modules/shipping/methods/fedex_v7/label_mgr/js_include.php b/trunk/modules/shipping/methods/fedex_v7/label_mgr/js_include.php
index 806e3cac..2558ccfb 100644
--- a/trunk/modules/shipping/methods/fedex_v7/label_mgr/js_include.php
+++ b/trunk/modules/shipping/methods/fedex_v7/label_mgr/js_include.php
@@ -21,7 +21,6 @@
 <!--
 // pass any php variables generated during pre-process that are used in the javascript functions.
 // Include translations here as well.
-var formName          = "<?php echo $_GET['form']; ?>"; 
 var image_delete_text = '<?php echo TEXT_DELETE; ?>';
 var image_delete_msg  = '<?php echo SHIPPING_DELETE_CONFIRM; ?>';
 <?php echo js_calendar_init($cal_ship); ?>
diff --git a/trunk/modules/shipping/pages/popup_shipping/js_include.php b/trunk/modules/shipping/pages/popup_shipping/js_include.php
index d0154a3e..e2e7c4d5 100644
--- a/trunk/modules/shipping/pages/popup_shipping/js_include.php
+++ b/trunk/modules/shipping/pages/popup_shipping/js_include.php
@@ -3,7 +3,6 @@
 // |                   PhreeBooks Open Source ERP                    |
 // +-----------------------------------------------------------------+
 // | Copyright(c) 2008-2014 PhreeSoft      (www.PhreeSoft.com)       |
-
 // +-----------------------------------------------------------------+
 // | This program is free software: you can redistribute it and/or   |
 // | modify it under the terms of the GNU General Public License as  |
@@ -22,8 +21,7 @@
 <!--
 // pass any php variables generated during pre-process that are used in the javascript functions.
 // Include translations here as well.
-var action   = '<?php echo $_REQUEST['action']; ?>'; 
-var formName = '<?php echo $_GET['form']; ?>'; 
+var action   = '<?php echo strip_alphanumeric($_REQUEST['action']); ?>'; 
 <?php echo js_calendar_init($cal_ship); ?>
 
 function init() {
