From 57475371a5b515c83bfc1bb2efcdf3ddb14787ed Mon Sep 17 00:00:00 2001
From: Marc Delisle <marc@infomarc.info>
Date: Fri, 11 Jul 2014 06:36:17 -0400
Subject: [PATCH] bug #4486 [security] XSS injection due to unescaped table
 comment

Signed-off-by: Marc Delisle <marc@infomarc.info>
---
 ChangeLog                   | 1 +
 libraries/structure.lib.php | 3 ++-
 2 files changed, 3 insertions(+), 1 deletion(-)

diff --git a/ChangeLog b/ChangeLog
index 6027e04dec6..431379ee70f 100644
--- a/ChangeLog
+++ b/ChangeLog
@@ -11,6 +11,7 @@ phpMyAdmin - ChangeLog
 - bug #4485 Sorting breaks the copy column feature
 - bug #4440 Javascript error when renaming table
 - bug #4483 'New window' link (selflink) disappears, causing Javascript error
+- bug #4486 [security] XSS injection due to unescaped table comment
 
 4.2.5.0 (2014-06-26)
 - bug #4467 shell_exec() has been disabled for security reasons
diff --git a/libraries/structure.lib.php b/libraries/structure.lib.php
index 27ddcc384ca..f8bf4bf5f9d 100644
--- a/libraries/structure.lib.php
+++ b/libraries/structure.lib.php
@@ -53,7 +53,8 @@ function PMA_getHtmlForActionLinks($current_table, $table_is_view, $tbl_url_quer
     $search_table .= '</a>';
 
     $browse_table_label = '<a href="sql.php?' . $tbl_url_query
-        . '&amp;pos=0" title="' . $current_table['TABLE_COMMENT'] . '">'
+        . '&amp;pos=0" title="'
+        . htmlspecialchars($current_table['TABLE_COMMENT']) . '">'
         . $truename . '</a>';
 
     if (!$db_is_system_schema) {
