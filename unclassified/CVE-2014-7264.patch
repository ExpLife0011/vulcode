From 43d1b6b266363ae7545d5d49851034eaeec7bebb Mon Sep 17 00:00:00 2001
From: Arian Xhezairi <arian@xhezairi.com>
Date: Mon, 17 Nov 2014 01:02:40 +0100
Subject: [PATCH] Fixed a potential XSS vulnerability.

Thanks JPCERT for reporting it to us.
---
 admin/themes/default/pages/manage_users.twig | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

diff --git a/admin/themes/default/pages/manage_users.twig b/admin/themes/default/pages/manage_users.twig
index 9711c4b3..6dca45cb 100644
--- a/admin/themes/default/pages/manage_users.twig
+++ b/admin/themes/default/pages/manage_users.twig
@@ -39,14 +39,14 @@
                     <tr id="user_$user.id" class="user{% if loop.last %} last{% endif %}">
                         <td class="main">
                             {% if user.full_name != "" %}
-                            <a href="mailto:$user.email">$user.full_name</a> <span class="sub">($user.login)</span>
+                            <a href="mailto:${ user.email | escape }">$user.full_name</a> <span class="sub">($user.login)</span>
                             {% else %}
-                            <a href="mailto:$user.email">$user.login</a>
+                            <a href="mailto:${ user.email | escape }">$user.login</a>
                             {% endif %}
                         </td>
                         <td>${ user.group.name | escape }</td>
                         <td>${ user.joined_at | strftime }</td>
-                        <td>{% if user.website != "" %}<a href="$user.website">$user.website</a>{% endif %}</td>
+                        <td>{% if user.website != "" %}<a href="${ user.website | escape }">$user.website</a>{% endif %}</td>
                         ${ trigger.call("manage_users_column", user) }
                         {% if user.editable and user.deletable %}
                         <td class="controls">${ user.edit_link('<img src="'~ theme_url ~'/images/icons/edit.svg" alt="edit" /> '~("edit" | translate)) }</td>
