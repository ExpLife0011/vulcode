From c8ec9c58a6b3c46cdd924532c1de99bcda6072ed Mon Sep 17 00:00:00 2001
From: Bauffman <davy@spoon-library.com>
Date: Tue, 14 Feb 2012 09:16:47 +0100
Subject: [PATCH] Make sure the highlight string doesn't contain html tags.

---
 backend/core/engine/base.php | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/backend/core/engine/base.php b/backend/core/engine/base.php
index ff9ef41d0d..73c0a83ff3 100644
--- a/backend/core/engine/base.php
+++ b/backend/core/engine/base.php
@@ -155,7 +155,10 @@ public function execute()
 			else $this->tpl->assign('reportMessage', BL::msg($messageName));
 
 			// highlight an element with the given id if needed
-			if($this->getParameter('highlight')) $this->tpl->assign('highlight', $this->getParameter('highlight'));
+			if($this->getParameter('highlight'))
+			{
+				$this->tpl->assign('highlight', strip_tags($this->getParameter('highlight')));
+			}
 		}
 
 		// is there an error to show?
