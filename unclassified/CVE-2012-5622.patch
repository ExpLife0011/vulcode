From 1ad0d1d792395306b59a34ad7b6e7e89a35d041e Mon Sep 17 00:00:00 2001
From: Chris Alfonso <calfonso@redhat.com>
Date: Mon, 3 Dec 2012 16:46:59 -0500
Subject: [PATCH] BZ878754 No CSRF attack protection in console

---
 openshift-console/app/controllers/application_controller.rb | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/openshift-console/app/controllers/application_controller.rb b/openshift-console/app/controllers/application_controller.rb
index 311a8750cd..e170f1ad2a 100644
--- a/openshift-console/app/controllers/application_controller.rb
+++ b/openshift-console/app/controllers/application_controller.rb
@@ -2,4 +2,9 @@ class ApplicationController < ActionController::Base
   include Console::Rescue
 
   protect_from_forgery
+
+  protected
+    def handle_unverified_request
+      raise Console::AccessDenied, "Request authenticity token does not match session #{session.inspect}"
+    end
 end
