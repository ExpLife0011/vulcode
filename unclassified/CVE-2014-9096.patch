From 4891c4d8742b9dabd67e7250840e3434865aebed Mon Sep 17 00:00:00 2001
From: yankidank <eric@pligg.com>
Date: Tue, 12 Aug 2014 09:25:26 -0700
Subject: [PATCH] - Added another layer of sanitization to the recover password
 page, as recommended by Dominik

---
 recover.php | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/recover.php b/recover.php
index 9efb96bb..a5c52fbe 100644
--- a/recover.php
+++ b/recover.php
@@ -28,7 +28,9 @@
 
 $id=sanitize($_REQUEST['id'], 3);
 $n=sanitize($_REQUEST['n'], 3);
-$username=base64_decode($id);
+$idTemp=base64_decode($id);
+$username=sanitize($idTemp ,3);
+
 $sql="SELECT * FROM `" . table_users . "` where `user_login` = '".$username."' AND `last_reset_request` = FROM_UNIXTIME('".$n."') AND user_level!='Spammer'";
 		
 $user = $db->get_row($sql);
