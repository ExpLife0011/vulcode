From 7d58f870e8edc6597485dd1b80ea9fb78580190c Mon Sep 17 00:00:00 2001
From: dennis <dennis@dennis-laptop>
Date: Wed, 13 Feb 2013 16:15:07 +0100
Subject: [PATCH] escape possible shell args

---
 upload/index.php | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

diff --git a/upload/index.php b/upload/index.php
index e504a22..dcb0ae3 100644
--- a/upload/index.php
+++ b/upload/index.php
@@ -1,5 +1,6 @@
 <?php
 
+
 if (!session::checkAccessControl('gallery_allow_edit')){
     return;
 }
@@ -71,8 +72,9 @@ public function uploadFile () {
                 return false;
             }
             
-            $zip = "/tmp/" . $_FILES['file']['name'];
-            $command = "mv " . $_FILES['file']['tmp_name'] . " $zip";
+            $zip = "/tmp/" . escapeshellcmd($_FILES['file']['name']);
+            //$zip = "/tmp/" . escapeshellcmd($_FILES['file']['name']);
+            $command = "mv " . escapeshellcmd($_FILES['file']['tmp_name']) . " $zip";
             //die;
             exec ($command, $output = array (), $res);
             if ($res) {
