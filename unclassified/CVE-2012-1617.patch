From 1e7626f4e1a26371480989c0b937f107ea9a6d4b Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Juan=20Ram=C3=B3n?= <juanramon.diaz@gmail.com>
Date: Wed, 1 Feb 2012 12:11:16 +0100
Subject: [PATCH] minor check in combine.php

---
 oc-content/themes/modern/combine.php | 5 +++++
 oc-includes/osclass/gui/combine.php  | 5 +++++
 2 files changed, 10 insertions(+)

diff --git a/oc-content/themes/modern/combine.php b/oc-content/themes/modern/combine.php
index c7716282a..7798bb86f 100644
--- a/oc-content/themes/modern/combine.php
+++ b/oc-content/themes/modern/combine.php
@@ -31,6 +31,11 @@
     $type     = $_GET['type'];
     $elements = explode(',', $_GET['files']);
 
+    if( !in_array($type, array('css', 'js')) ) {
+        header ("HTTP/1.0 403 Forbidden") ;
+        exit ;
+    }
+
     // Determine last modification date of the files
     $lastmodified = 0;
     while( list(,$element) = each($elements) ) {
diff --git a/oc-includes/osclass/gui/combine.php b/oc-includes/osclass/gui/combine.php
index c7716282a..7798bb86f 100644
--- a/oc-includes/osclass/gui/combine.php
+++ b/oc-includes/osclass/gui/combine.php
@@ -31,6 +31,11 @@
     $type     = $_GET['type'];
     $elements = explode(',', $_GET['files']);
 
+    if( !in_array($type, array('css', 'js')) ) {
+        header ("HTTP/1.0 403 Forbidden") ;
+        exit ;
+    }
+
     // Determine last modification date of the files
     $lastmodified = 0;
     while( list(,$element) = each($elements) ) {
