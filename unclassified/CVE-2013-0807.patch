From 40f1b4a5749a621cd27c5ca39900dbcf8701969d Mon Sep 17 00:00:00 2001
From: Josh Schmidt <oyejorge@gmail.com>
Date: Wed, 2 Jan 2013 12:07:30 -0700
Subject: [PATCH] new_section vulnerability fixed

---
 include/tool/editing_page.php | 3 +--
 1 file changed, 1 insertion(+), 2 deletions(-)

diff --git a/include/tool/editing_page.php b/include/tool/editing_page.php
index 20a3551f..f5dc3f15 100755
--- a/include/tool/editing_page.php
+++ b/include/tool/editing_page.php
@@ -451,7 +451,6 @@ static function GetDefaultContent($type){
 	function NewSectionPrompt(){
 		global $langmessage;
 
-
 		ob_start();
 		echo '<div class="inline_box">';
 		echo '<form method="post" action="'.common::GetUrl($this->title).'">';
@@ -481,7 +480,7 @@ function NewSectionPrompt(){
 
 		echo '<p>';
 		echo '<input type="hidden" name="last_mod" value="'.$this->fileModTime.'" />';
-		echo '<input type="hidden" name="section" value="'.$_GET['section'].'" />';
+		echo '<input type="hidden" name="section" value="'.htmlspecialchars($_GET['section']).'" />';
 		echo '<input type="hidden" name="cmd" value="add_section" />';
 		echo '<input type="submit" name="" value="'.$langmessage['save'].'" class="gpsubmit"/>';
 		echo ' <input type="button" name="" value="'.$langmessage['cancel'].'" class="admin_box_close gpcancel" />';
